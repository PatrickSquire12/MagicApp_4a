<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Welcome</title>
    <script>
        function openPopup(fileType, index) {
            const popup = window.open("", "Popup", "width=600,height=400");
            popup.document.write(`
                <html>
                    <head>
                        <title>Paste Text</title>
                    </head>
                    <body>
                        <h3>Paste your text for ${fileType} ${index}:</h3>
                        <textarea id="textContent" rows="20" cols="60"></textarea><br>
                        <button onclick="window.opener.submitText('${fileType}', ${index}, document.getElementById('textContent').value); window.close();">Submit</button>
                    </body>
                </html>
            `);
        }

        function submitText(fileType, index, text) {
            fetch('/update_file', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ type: fileType, index: index, text: text })
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
    </script>
</head>
<body>
    <h1>Welcome, {{ username }}!</h1>

    <button onclick="openPopup('Collection', 1)">Paste Collection Here</button>
    {% for i in range(1, 21) %}
        <button onclick="openPopup('Deck', {{ i }})">Paste Deck {{ i }} Here</button>
    {% endfor %}
</body>
</html>
